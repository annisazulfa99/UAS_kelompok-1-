<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.ToggleButton?>
<?import javafx.scene.control.ToggleGroup?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<BorderPane style="-fx-background-color: #F5E6D3;" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.inventaris.controller.PeminjamanInstansiController">

    <!-- LEFT SIDEBAR: TAB NAVIGATION -->
    <left>
        <VBox spacing="20" style="-fx-background-color: #6A5436; -fx-padding: 30; -fx-pref-width: 250;">
            
            <Label style="-fx-text-fill: white; -fx-font-size: 20px; -fx-font-weight: bold; -fx-underline: true;" text="Kelola Peminjaman">
                <VBox.margin>
                    <Insets bottom="20" />
                </VBox.margin>
            </Label>

            <fx:define>
                <ToggleGroup fx:id="tabGroup" />
            </fx:define>

            <ToggleButton fx:id="tabPengajuan" maxWidth="Infinity" onAction="#handleTabChange" prefHeight="50" selected="true" style="-fx-background-color: #8C6E63; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 10;" text="PENGAJUAN MASUK" toggleGroup="$tabGroup" />

            <ToggleButton fx:id="tabSedang" maxWidth="Infinity" onAction="#handleTabChange" prefHeight="50" style="-fx-background-color: #D9CBC1; -fx-text-fill: black; -fx-font-weight: bold; -fx-background-radius: 10; -fx-cursor: hand;" text="SEDANG DIPINJAM" toggleGroup="$tabGroup" />
            
            <ToggleButton fx:id="tabPengembalian" maxWidth="Infinity" onAction="#handleTabChange" prefHeight="50" style="-fx-background-color: #D9CBC1; -fx-text-fill: black; -fx-font-weight: bold; -fx-background-radius: 10; -fx-cursor: hand;" text="PENGEMBALIAN" toggleGroup="$tabGroup" />
            
            <ToggleButton fx:id="tabRiwayat" maxWidth="Infinity" onAction="#handleTabChange" prefHeight="50" style="-fx-background-color: #D9CBC1; -fx-text-fill: black; -fx-font-weight: bold; -fx-background-radius: 10; -fx-cursor: hand;" text="RIWAYAT" toggleGroup="$tabGroup" />

            <Region VBox.vgrow="ALWAYS" />
            
            <VBox spacing="10" style="-fx-background-color: rgba(255,255,255,0.1); -fx-padding: 15; -fx-background-radius: 10;">
                <Label style="-fx-text-fill: white; -fx-font-size: 12px; -fx-wrap-text: true;" text="ðŸ’¡ Tip: Periksa pengajuan secara berkala untuk memastikan layanan optimal." wrapText="true" />
            </VBox>
        </VBox>
    </left>
    
    <!-- CENTER: CONTENT AREA -->
    <center>
        <VBox spacing="20" style="-fx-padding: 20;" VBox.vgrow="ALWAYS">

            <VBox spacing="20" style="-fx-background-color: white; -fx-padding: 30; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 5);" VBox.vgrow="ALWAYS">

                <!-- ================================================ -->
                <!-- TAB 1: PENGAJUAN MASUK (pending_instansi) -->
                <!-- ================================================ -->
                <VBox fx:id="contentPengajuan" spacing="25" VBox.vgrow="ALWAYS">
                    
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <Label style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #6A5436;" text="ðŸ“¥ Pengajuan Peminjaman Masuk" />
                        <Region HBox.hgrow="ALWAYS" />
                    </HBox>
                    
                    <VBox spacing="10" style="-fx-background-color: #FFF3CD; -fx-padding: 15; -fx-background-radius: 8;">
                        <Label style="-fx-font-weight: bold; -fx-text-fill: #856404;" text="âš ï¸ Penting:" />
                        <Label style="-fx-font-size: 12px; -fx-text-fill: #856404;" text="â€¢ Pastikan stok barang mencukupi sebelum menyetujui" />
                        <Label style="-fx-font-size: 12px; -fx-text-fill: #856404;" text="â€¢ Stok akan otomatis dikurangi setelah approval" />
                        <Label style="-fx-font-size: 12px; -fx-text-fill: #856404;" text="â€¢ Berikan alasan jelas saat menolak pengajuan" />
                    </VBox>
                    
                    <Separator />
                    
                    <TableView fx:id="tablePengajuan" minHeight="400.0" prefHeight="500.0" style="-fx-padding: 10;" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colPengajuanId" prefWidth="50" text="ID" />
                            <TableColumn fx:id="colPengajuanPeminjam" prefWidth="150" text="PEMINJAM" />
                            <TableColumn fx:id="colPengajuanBarang" prefWidth="180" text="BARANG" />
                            <TableColumn fx:id="colPengajuanJumlah" prefWidth="70" text="JUMLAH" />
                            <TableColumn fx:id="colPengajuanTglPinjam" prefWidth="110" text="TGL PINJAM" />
                            <TableColumn fx:id="colPengajuanDeadline" prefWidth="110" text="DEADLINE" />
                            <TableColumn fx:id="colPengajuanAction" prefWidth="150" text="AKSI" />
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                        <placeholder>
                            <VBox alignment="CENTER" spacing="10" style="-fx-padding: 50;">
                                <Label style="-fx-font-size: 48px;" text="âœ…" />
                                <Label style="-fx-font-size: 16px; -fx-text-fill: #666;" text="Tidak ada pengajuan baru" />
                                <Label style="-fx-font-size: 12px; -fx-text-fill: #999;" text="Pengajuan baru akan muncul di sini" />
                            </VBox>
                        </placeholder>
                    </TableView>
                </VBox>
                
                <!-- ================================================ -->
                <!-- TAB 2: SEDANG DIPINJAM (approved_instansi) -->
                <!-- ================================================ -->
                <VBox fx:id="contentSedang" managed="false" spacing="25" visible="false" VBox.vgrow="ALWAYS">
                    
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <Label style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #6A5436;" text="ðŸ“¦ Barang Sedang Dipinjam" />
                        <Region HBox.hgrow="ALWAYS" />
                    </HBox>
                    
                    <Separator />
                    
                    <TableView fx:id="tableSedang" minHeight="400.0" prefHeight="500.0" style="-fx-padding: 10;" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colSedangId" prefWidth="50" text="ID" />
                            <TableColumn fx:id="colSedangPeminjam" prefWidth="150" text="PEMINJAM" />
                            <TableColumn fx:id="colSedangBarang" prefWidth="180" text="BARANG" />
                            <TableColumn fx:id="colSedangJumlah" prefWidth="70" text="JML" />
                            <TableColumn fx:id="colSedangTglPinjam" prefWidth="110" text="TGL PINJAM" />
                            <TableColumn fx:id="colSedangDeadline" prefWidth="110" text="DEADLINE" />
                            <TableColumn fx:id="colSedangSisa" prefWidth="100" text="SISA HARI" />
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                        <placeholder>
                            <VBox alignment="CENTER" spacing="10" style="-fx-padding: 50;">
                                <Label style="-fx-font-size: 48px;" text="ðŸ“­" />
                                <Label style="-fx-font-size: 16px; -fx-text-fill: #666;" text="Tidak ada peminjaman aktif" />
                            </VBox>
                        </placeholder>
                    </TableView>
                </VBox>
                
                <!-- ================================================ -->
                <!-- TAB 3: PENGAJUAN PENGEMBALIAN (pending_return) -->
                <!-- ================================================ -->
                <VBox fx:id="contentPengembalian" managed="false" spacing="25" visible="false" VBox.vgrow="ALWAYS">
                    
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <Label style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #6A5436;" text="ðŸ”„ Pengajuan Pengembalian" />
                        <Region HBox.hgrow="ALWAYS" />
                    </HBox>
                    
                    <VBox spacing="10" style="-fx-background-color: #D1ECF1; -fx-padding: 15; -fx-background-radius: 8;">
                        <Label style="-fx-font-weight: bold; -fx-text-fill: #0C5460;" text="â„¹ï¸ Informasi:" />
                        <Label style="-fx-font-size: 12px; -fx-text-fill: #0C5460;" text="â€¢ Periksa kondisi barang dengan teliti" />
                        <Label style="-fx-font-size: 12px; -fx-text-fill: #0C5460;" text="â€¢ Stok akan bertambah HANYA untuk barang kondisi BAIK" />
                        <Label style="-fx-font-size: 12px; -fx-text-fill: #0C5460;" text="â€¢ Jika ada rusak/hilang, buat laporan setelah approval" />
                    </VBox>
                    
                    <Separator />
                    
                    <TableView fx:id="tablePengembalian" minHeight="400.0" prefHeight="500.0" style="-fx-padding: 10;" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colPengembalianId" prefWidth="50" text="ID" />
                            <TableColumn fx:id="colPengembalianPeminjam" prefWidth="120" text="PEMINJAM" />
                            <TableColumn fx:id="colPengembalianBarang" prefWidth="150" text="BARANG" />
                            <TableColumn fx:id="colPengembalianBaik" prefWidth="60" text="BAIK" />
                            <TableColumn fx:id="colPengembalianRusak" prefWidth="60" text="RUSAK" />
                            <TableColumn fx:id="colPengembalianHilang" prefWidth="60" text="HILANG" />
                            <TableColumn fx:id="colPengembalianCatatan" prefWidth="150" text="CATATAN" />
                            <TableColumn fx:id="colPengembalianAction" prefWidth="130" text="AKSI" />
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                        <placeholder>
                            <VBox alignment="CENTER" spacing="10" style="-fx-padding: 50;">
                                <Label style="-fx-font-size: 48px;" text="âœ…" />
                                <Label style="-fx-font-size: 16px; -fx-text-fill: #666;" text="Tidak ada pengajuan pengembalian" />
                            </VBox>
                        </placeholder>
                    </TableView>
                </VBox>
                
                <!-- ================================================ -->
                <!-- TAB 4: RIWAYAT -->
                <!-- ================================================ -->
                <VBox fx:id="contentRiwayat" managed="false" spacing="25" visible="false" VBox.vgrow="ALWAYS">
                    
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <Label style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #6A5436;" text="ðŸ“‹ Riwayat Peminjaman" />
                        <Region HBox.hgrow="ALWAYS" />
                    </HBox>
                    
                    <Separator />
                    
                    <TableView fx:id="tableRiwayat" minHeight="400.0" prefHeight="500.0" style="-fx-padding: 10;" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colRiwayatId" prefWidth="50" text="ID" />
                            <TableColumn fx:id="colRiwayatPeminjam" prefWidth="150" text="PEMINJAM" />
                            <TableColumn fx:id="colRiwayatBarang" prefWidth="180" text="BARANG" />
                            <TableColumn fx:id="colRiwayatJumlah" prefWidth="70" text="JML" />
                            <TableColumn fx:id="colRiwayatTglPinjam" prefWidth="110" text="TGL PINJAM" />
                            <TableColumn fx:id="colRiwayatTglKembali" prefWidth="110" text="TGL KEMBALI" />
                            <TableColumn fx:id="colRiwayatStatus" prefWidth="150" text="STATUS" />
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                        <placeholder>
                            <VBox alignment="CENTER" spacing="10" style="-fx-padding: 50;">
                                <Label style="-fx-font-size: 48px;" text="ðŸ“‚" />
                                <Label style="-fx-font-size: 16px; -fx-text-fill: #666;" text="Belum ada riwayat" />
                            </VBox>
                        </placeholder>
                    </TableView>
                </VBox>

            </VBox>
        </VBox>
    </center>

</BorderPane>